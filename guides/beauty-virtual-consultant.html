<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <!-- Primary Meta Tags -->
    <title>Build an AI Beauty Consultant | AI Build Guides | Vibe Coding Enthusiast</title>
    <meta name="title" content="Build an AI Beauty Consultant | AI Build Guides | Vibe Coding Enthusiast">
    <meta name="description" content="Build a personalized AI beauty recommendations chatbot with Next.js, Claude API, and Supabase. Create skin type analysis, product recommendations, and custom skincare routines.">
    <meta name="keywords" content="ai beauty consultant, beauty chatbot, skincare recommendations, claude api, next.js, supabase, ai development, vibe coding, build guide, tutorial">
    <meta name="author" content="Vibe Coding Enthusiast">
    <meta name="robots" content="index, follow">
    <link rel="canonical" href="https://vibecodingenthusiast.com/guides/beauty-virtual-consultant.html">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://vibecodingenthusiast.com/guides/beauty-virtual-consultant.html">
    <meta property="og:title" content="Build an AI Beauty Consultant | AI Build Guides">
    <meta property="og:description" content="Build a personalized AI beauty recommendations chatbot with Next.js, Claude API, and Supabase. Create skin type analysis, product recommendations, and custom skincare routines.">
    <meta property="og:image" content="https://vibecodingenthusiast.com/guides/images/beauty-virtual-consultant-og.png">
    <meta property="og:site_name" content="Vibe Coding Enthusiast">
    <meta property="og:locale" content="en_US">
    <meta property="article:published_time" content="2025-01-14">
    <meta property="article:modified_time" content="2025-01-14">
    <meta property="article:author" content="Vibe Coding Enthusiast">
    <meta property="article:section" content="AI Build Guides">
    <meta property="article:tag" content="AI Beauty">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://vibecodingenthusiast.com/guides/beauty-virtual-consultant.html">
    <meta name="twitter:title" content="Build an AI Beauty Consultant | AI Build Guides">
    <meta name="twitter:description" content="Build a personalized AI beauty recommendations chatbot with Next.js, Claude API, and Supabase. Create skin type analysis, product recommendations, and custom skincare routines.">
    <meta name="twitter:image" content="https://vibecodingenthusiast.com/guides/images/beauty-virtual-consultant-og.png">
    <meta name="twitter:creator" content="@vibecodingenthusiast">

    <!-- Schema.org JSON-LD for TechArticle -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "TechArticle",
        "headline": "Build an AI Beauty Consultant",
        "description": "Build a personalized AI beauty recommendations chatbot with Next.js, Claude API, and Supabase. Create skin type analysis, product recommendations, and custom skincare routines.",
        "image": "https://vibecodingenthusiast.com/guides/images/beauty-virtual-consultant-og.png",
        "author": {
            "@type": "Organization",
            "name": "Vibe Coding Enthusiast",
            "url": "https://vibecodingenthusiast.com"
        },
        "publisher": {
            "@type": "Organization",
            "name": "Vibe Coding Enthusiast",
            "logo": {
                "@type": "ImageObject",
                "url": "https://vibecodingenthusiast.com/favicon.png"
            }
        },
        "datePublished": "2025-01-14",
        "dateModified": "2025-01-14",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://vibecodingenthusiast.com/guides/beauty-virtual-consultant.html"
        },
        "articleSection": "AI Build Guides",
        "keywords": "ai beauty consultant, beauty chatbot, skincare recommendations, claude api, next.js, supabase",
        "proficiencyLevel": "Beginner",
        "dependencies": "Next.js 14, Tailwind CSS, Supabase, Claude API, Vercel",
        "timeRequired": "PT180M"
    }
    </script>

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/styles.css">

</head>
<body>
    <a href="#main" class="skip-link">Skip to main content</a>

    <!-- Reading Progress Bar -->
    <div class="reading-progress" id="readingProgress" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" aria-label="Reading progress"></div>

    <!-- Header -->
    <header class="header">
        <nav class="nav container" role="navigation" aria-label="Main navigation">
            <a href="/" class="logo" aria-label="Vibe Coding Enthusiast - Home">
                <img src="/favicon.png" alt="Vibe Coding Enthusiast" class="logo-icon" width="28" height="28">
                <span class="logo-text">VibeCoding<span class="accent">Enthusiast</span></span>
            </a>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/guides/">Guides</a></li>
                <li><a href="/paths/">Paths</a></li>
                <li><a href="/learn/">Learn</a></li>
                <li><a href="/tools/">Tools</a></li>
                <li><a href="/stacks/">Stacks</a></li>
                <li><a href="/industries/">Industries</a></li>
                <li><a href="/#about">About</a></li>
            </ul>
            <div class="nav-actions">
                <a href="/guides/" class="btn btn-primary">Explore Guides</a>
            </div>
            <button class="mobile-menu-btn" aria-label="Toggle menu" aria-expanded="false">
                <span></span><span></span><span></span>
            </button>
        </nav>
    </header>

    <main id="main">
        <!-- Article Header -->
        <section class="article-header">
            <div class="container">
                <!-- Breadcrumb Navigation -->
                <nav class="breadcrumb" aria-label="Breadcrumb">
                    <a href="/">Home</a>
                    <span class="breadcrumb-separator" aria-hidden="true">/</span>
                    <a href="/guides/">Guides</a>
                    <span class="breadcrumb-separator" aria-hidden="true">/</span>
                    <span class="breadcrumb-current" aria-current="page">AI Beauty Consultant</span>
                </nav>

                <!-- Guide Meta Badges -->
                <div class="guide-meta">
                    <span class="badge badge-beginner">Beginner</span>
                    <span class="badge badge-time">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        ~3 hours
                    </span>
                </div>

                <!-- Title -->
                <h1 class="gradient-text-beauty">Build an AI Beauty Consultant</h1>

                <!-- Description -->
                <p class="lead">Create a personalized AI-powered beauty recommendations chatbot that analyzes skin types, suggests products, and builds custom skincare routines using Claude API, Next.js, and Supabase.</p>

                <!-- Share Buttons -->
                <div class="share-buttons" role="group" aria-label="Share this guide">
                    <button class="share-btn" data-share="twitter" title="Share on Twitter" aria-label="Share on Twitter">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                        </svg>
                    </button>
                    <button class="share-btn" data-share="linkedin" title="Share on LinkedIn" aria-label="Share on LinkedIn">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                            <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                        </svg>
                    </button>
                    <button class="share-btn" data-share="copy" title="Copy link" aria-label="Copy link to clipboard">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                            <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                            <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </section>

        <!-- Main Content with TOC Sidebar -->
        <div class="article-layout">
            <!-- Table of Contents Sidebar -->
            <aside class="toc-sidebar" aria-label="Table of contents">
                <div class="toc-title">On this page</div>
                <ul class="toc-list" id="tocList">
                    <noscript>
                        <li><a href="#overview">What We're Building</a></li>
                        <li><a href="#prerequisites">Prerequisites</a></li>
                        <li><a href="#tech-stack">Tech Stack</a></li>
                        <li><a href="#ai-workflow">AI Agent Workflow</a></li>
                        <li><a href="#build-steps">Build Steps</a></li>
                        <li><a href="#common-issues">Common Issues</a></li>
                        <li><a href="#next-steps">Next Steps</a></li>
                    </noscript>
                </ul>
            </aside>

            <!-- Article Content -->
            <article class="article-content">
                <!-- Section: What We're Building -->
                <h2 id="overview">What We're Building</h2>
                <p>In this guide, you'll build a complete AI-powered beauty consultant chatbot that provides personalized skincare and beauty recommendations. The app will feature a conversational interface where users can discuss their skin concerns, get product suggestions, and receive customized skincare routines.</p>

                <div class="feature-grid">
                    <div class="feature-item">
                        <span class="feature-item-icon">üí¨</span>
                        <div class="feature-item-text">
                            <strong>Chat Interface</strong>
                            Natural conversation with AI beauty expert
                        </div>
                    </div>
                    <div class="feature-item">
                        <span class="feature-item-icon">üß¥</span>
                        <div class="feature-item-text">
                            <strong>Product Recommendations</strong>
                            AI-curated suggestions based on skin type
                        </div>
                    </div>
                    <div class="feature-item">
                        <span class="feature-item-icon">üìã</span>
                        <div class="feature-item-text">
                            <strong>Skin Analysis</strong>
                            Questionnaire to determine skin profile
                        </div>
                    </div>
                    <div class="feature-item">
                        <span class="feature-item-icon">‚ú®</span>
                        <div class="feature-item-text">
                            <strong>Routine Builder</strong>
                            Personalized AM/PM skincare routines
                        </div>
                    </div>
                </div>

                <p>By the end of this guide, you'll have a deployed application that beauty enthusiasts can use to get expert-level skincare advice powered by Claude's advanced language understanding.</p>

                <!-- Section: Prerequisites -->
                <h2 id="prerequisites">Prerequisites</h2>
                <p>Before starting this guide, make sure you have the following:</p>
                <ul>
                    <li><strong>Node.js 18+</strong> installed on your machine</li>
                    <li><strong>Anthropic API key</strong> - Sign up at <a href="https://console.anthropic.com" target="_blank">console.anthropic.com</a></li>
                    <li><strong>Supabase account</strong> - Free tier available at <a href="https://supabase.com" target="_blank">supabase.com</a></li>
                    <li><strong>Vercel account</strong> - For deployment (optional but recommended)</li>
                    <li>Basic familiarity with React and TypeScript</li>
                </ul>

                <!-- Section: Tech Stack -->
                <h2 id="tech-stack">Tech Stack Specification</h2>
                <p>Here's the technology stack we'll use for this build:</p>
                <table class="tech-stack-table">
                    <thead>
                        <tr>
                            <th scope="col">Layer</th>
                            <th scope="col">Technology</th>
                            <th scope="col">Why This Choice</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Frontend</td>
                            <td>Next.js 14, Tailwind CSS</td>
                            <td>Modern React framework with built-in routing and excellent DX for building chat UIs</td>
                        </tr>
                        <tr>
                            <td>Backend</td>
                            <td>Next.js API Routes</td>
                            <td>Serverless functions that integrate seamlessly with the frontend</td>
                        </tr>
                        <tr>
                            <td>Database</td>
                            <td>Supabase</td>
                            <td>PostgreSQL with real-time subscriptions, perfect for storing user preferences and chat history</td>
                        </tr>
                        <tr>
                            <td>AI</td>
                            <td>Claude API</td>
                            <td>Best-in-class reasoning for nuanced beauty recommendations and skin analysis</td>
                        </tr>
                        <tr>
                            <td>Hosting</td>
                            <td>Vercel</td>
                            <td>Zero-config deployment with edge functions and excellent Next.js support</td>
                        </tr>
                    </tbody>
                </table>

                <!-- Section: AI Agent Workflow -->
                <h2 id="ai-workflow">AI Agent Workflow</h2>
                <p>Here's how to leverage AI tools throughout this build to maximize productivity:</p>

                <h3 id="ai-scaffolding">Project Scaffolding with Claude Code</h3>
                <p>Use Claude Code to quickly generate the project structure, components, and API routes. Here's how to prompt it effectively:</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">Prompt</span>
                        <button class="code-copy-btn" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code><span class="comment"># Example prompt for Claude Code</span>
Create a Next.js 14 app with the following structure:
- Chat interface component with message bubbles
- Skin type questionnaire with multi-step form
- API route for Claude integration
- Supabase client setup for user preferences
- Tailwind CSS styling with pink/purple beauty theme</code></pre>
                </div>

                <h3 id="ai-ui">UI Generation with v0.dev</h3>
                <p>v0.dev is excellent for quickly generating beautiful chat interfaces and form components. Use it to create the visual foundation of your beauty consultant.</p>

                <div class="callout callout-tip">
                    <div class="callout-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg>
                        Pro Tip
                    </div>
                    <p>When prompting v0.dev, include specific details like "beauty/skincare themed chat interface with gradient backgrounds, rounded message bubbles, and a product recommendation card component."</p>
                </div>

                <h3 id="ai-debugging">Development with Cursor</h3>
                <p>Cursor's AI features help you iterate quickly on the codebase. Use Cmd+K to generate code blocks, and Cmd+L to chat about implementation details. It's particularly useful for debugging Claude API integration issues.</p>

                <!-- Section: Build Steps -->
                <h2 id="build-steps">Step-by-Step Build Guide</h2>

                <h3 id="phase-1">Phase 1: Chat Interface Setup</h3>
                <p>Start by creating the core chat interface. This will be the primary way users interact with the AI beauty consultant.</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">bash</span>
                        <button class="code-copy-btn" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code><span class="comment"># Create Next.js project</span>
npx create-next-app@latest beauty-consultant --typescript --tailwind --app
cd beauty-consultant

<span class="comment"># Install dependencies</span>
npm install @anthropic-ai/sdk @supabase/supabase-js</code></pre>
                </div>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">tsx</span>
                        <button class="code-copy-btn" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code><span class="comment">// components/ChatInterface.tsx</span>
<span class="keyword">import</span> { useState } <span class="keyword">from</span> <span class="string">'react'</span>;

<span class="keyword">interface</span> Message {
  role: <span class="string">'user'</span> | <span class="string">'assistant'</span>;
  content: <span class="keyword">string</span>;
}

<span class="keyword">export default function</span> <span class="function">ChatInterface</span>() {
  <span class="keyword">const</span> [messages, setMessages] = <span class="function">useState</span>&lt;Message[]&gt;([]);
  <span class="keyword">const</span> [input, setInput] = <span class="function">useState</span>(<span class="string">''</span>);
  <span class="keyword">const</span> [isLoading, setIsLoading] = <span class="function">useState</span>(<span class="keyword">false</span>);

  <span class="keyword">const</span> <span class="function">sendMessage</span> = <span class="keyword">async</span> () => {
    <span class="keyword">if</span> (!input.trim()) <span class="keyword">return</span>;

    <span class="keyword">const</span> userMessage = { role: <span class="string">'user'</span>, content: input };
    setMessages(prev => [...prev, userMessage]);
    setInput(<span class="string">''</span>);
    setIsLoading(<span class="keyword">true</span>);

    <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="function">fetch</span>(<span class="string">'/api/chat'</span>, {
      method: <span class="string">'POST'</span>,
      headers: { <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span> },
      body: <span class="function">JSON.stringify</span>({ messages: [...messages, userMessage] })
    });

    <span class="keyword">const</span> data = <span class="keyword">await</span> response.<span class="function">json</span>();
    setMessages(prev => [...prev, { role: <span class="string">'assistant'</span>, content: data.message }]);
    setIsLoading(<span class="keyword">false</span>);
  };

  <span class="keyword">return</span> (
    &lt;div className=<span class="string">"flex flex-col h-screen bg-gradient-to-br from-pink-50 to-purple-50"</span>&gt;
      {<span class="comment">/* Message display area */</span>}
      &lt;div className=<span class="string">"flex-1 overflow-y-auto p-4 space-y-4"</span>&gt;
        {messages.<span class="function">map</span>((msg, i) =&gt; (
          &lt;div key={i} className={`flex ${msg.role === <span class="string">'user'</span> ? <span class="string">'justify-end'</span> : <span class="string">'justify-start'</span>}`}&gt;
            &lt;div className={`max-w-[80%] p-4 rounded-2xl ${
              msg.role === <span class="string">'user'</span>
                ? <span class="string">'bg-pink-500 text-white'</span>
                : <span class="string">'bg-white shadow-md'</span>
            }`}&gt;
              {msg.content}
            &lt;/div&gt;
          &lt;/div&gt;
        ))}
      &lt;/div&gt;
      {<span class="comment">/* Input area */</span>}
      &lt;div className=<span class="string">"p-4 bg-white border-t"</span>&gt;
        &lt;div className=<span class="string">"flex gap-2"</span>&gt;
          &lt;input
            value={input}
            onChange={(e) =&gt; <span class="function">setInput</span>(e.target.value)}
            onKeyPress={(e) =&gt; e.key === <span class="string">'Enter'</span> &amp;&amp; <span class="function">sendMessage</span>()}
            placeholder=<span class="string">"Ask about skincare, products, routines..."</span>
            className=<span class="string">"flex-1 p-3 border rounded-xl focus:ring-2 focus:ring-pink-300"</span>
          /&gt;
          &lt;button
            onClick={sendMessage}
            disabled={isLoading}
            className=<span class="string">"px-6 py-3 bg-pink-500 text-white rounded-xl hover:bg-pink-600"</span>
          &gt;
            Send
          &lt;/button&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}</code></pre>
                </div>

                <h3 id="phase-2">Phase 2: User Preference Questionnaire</h3>
                <p>Create a multi-step questionnaire to gather user skin information. This data will be used to personalize recommendations.</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">tsx</span>
                        <button class="code-copy-btn" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code><span class="comment">// components/SkinQuiz.tsx</span>
<span class="keyword">const</span> questions = [
  {
    id: <span class="string">'skinType'</span>,
    question: <span class="string">'How would you describe your skin?'</span>,
    options: [<span class="string">'Oily'</span>, <span class="string">'Dry'</span>, <span class="string">'Combination'</span>, <span class="string">'Normal'</span>, <span class="string">'Sensitive'</span>]
  },
  {
    id: <span class="string">'concerns'</span>,
    question: <span class="string">'What are your main skin concerns?'</span>,
    options: [<span class="string">'Acne'</span>, <span class="string">'Aging'</span>, <span class="string">'Dark spots'</span>, <span class="string">'Dryness'</span>, <span class="string">'Redness'</span>, <span class="string">'Texture'</span>],
    multiple: <span class="keyword">true</span>
  },
  {
    id: <span class="string">'budget'</span>,
    question: <span class="string">'What\'s your skincare budget?'</span>,
    options: [<span class="string">'Drugstore ($)'</span>, <span class="string">'Mid-range ($$)'</span>, <span class="string">'Luxury ($$$)'</span>, <span class="string">'No limit'</span>]
  },
  {
    id: <span class="string">'routine'</span>,
    question: <span class="string">'How much time for your routine?'</span>,
    options: [<span class="string">'Quick (2-3 steps)'</span>, <span class="string">'Moderate (4-5 steps)'</span>, <span class="string">'Extensive (6+ steps)'</span>]
  }
];</code></pre>
                </div>

                <h3 id="phase-3">Phase 3: Product Database Schema</h3>
                <p>Set up Supabase to store products and user preferences. This enables personalized recommendations that improve over time.</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">sql</span>
                        <button class="code-copy-btn" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code><span class="comment">-- Supabase SQL schema</span>

<span class="comment">-- User preferences table</span>
<span class="keyword">CREATE TABLE</span> user_preferences (
  id UUID <span class="keyword">DEFAULT</span> uuid_generate_v4() <span class="keyword">PRIMARY KEY</span>,
  user_id UUID <span class="keyword">REFERENCES</span> auth.users,
  skin_type TEXT,
  concerns TEXT[],
  budget TEXT,
  routine_preference TEXT,
  created_at TIMESTAMPTZ <span class="keyword">DEFAULT</span> NOW()
);

<span class="comment">-- Products table</span>
<span class="keyword">CREATE TABLE</span> products (
  id UUID <span class="keyword">DEFAULT</span> uuid_generate_v4() <span class="keyword">PRIMARY KEY</span>,
  name TEXT <span class="keyword">NOT NULL</span>,
  brand TEXT,
  category TEXT,
  price_range TEXT,
  skin_types TEXT[],
  concerns TEXT[],
  ingredients TEXT[],
  description TEXT,
  image_url TEXT
);

<span class="comment">-- Chat history for context</span>
<span class="keyword">CREATE TABLE</span> chat_history (
  id UUID <span class="keyword">DEFAULT</span> uuid_generate_v4() <span class="keyword">PRIMARY KEY</span>,
  user_id UUID <span class="keyword">REFERENCES</span> auth.users,
  messages JSONB,
  created_at TIMESTAMPTZ <span class="keyword">DEFAULT</span> NOW()
);</code></pre>
                </div>

                <h3 id="phase-4">Phase 4: AI Recommendation Engine</h3>
                <p>This is the core of your beauty consultant - the Claude API integration with specialized beauty prompts.</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">typescript</span>
                        <button class="code-copy-btn" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code><span class="comment">// app/api/chat/route.ts</span>
<span class="keyword">import</span> Anthropic <span class="keyword">from</span> <span class="string">'@anthropic-ai/sdk'</span>;
<span class="keyword">import</span> { NextResponse } <span class="keyword">from</span> <span class="string">'next/server'</span>;

<span class="keyword">const</span> anthropic = <span class="keyword">new</span> <span class="function">Anthropic</span>({
  apiKey: process.env.ANTHROPIC_API_KEY!
});

<span class="keyword">const</span> BEAUTY_SYSTEM_PROMPT = <span class="string">`You are an expert AI beauty consultant with deep knowledge of
skincare, makeup, and beauty routines. Your expertise includes:

- Dermatology-backed skincare recommendations
- Product ingredient analysis (retinoids, AHAs, BHAs, peptides, etc.)
- Customized routine building for AM and PM
- Understanding skin types, concerns, and how they interact
- Budget-conscious recommendations across all price points

Guidelines:
1. Always ask clarifying questions about skin type and concerns if not provided
2. Explain WHY you're recommending specific products or ingredients
3. Warn about potential irritants or ingredient conflicts
4. Suggest patch testing for new products
5. Be encouraging and supportive about skincare journeys

Format recommendations clearly with:
- Product name and brand
- Key ingredients and their benefits
- How to use (when in routine, frequency)
- Price range indicator ($, $$, $$$)`</span>;

<span class="keyword">export async function</span> <span class="function">POST</span>(req: Request) {
  <span class="keyword">const</span> { messages, userPreferences } = <span class="keyword">await</span> req.<span class="function">json</span>();

  <span class="comment">// Build context from user preferences if available</span>
  <span class="keyword">let</span> contextPrompt = BEAUTY_SYSTEM_PROMPT;
  <span class="keyword">if</span> (userPreferences) {
    contextPrompt += <span class="string">`\n\nUser Profile:
- Skin Type: ${userPreferences.skinType}
- Main Concerns: ${userPreferences.concerns?.join(', ')}
- Budget: ${userPreferences.budget}
- Routine Preference: ${userPreferences.routine}`</span>;
  }

  <span class="keyword">const</span> response = <span class="keyword">await</span> anthropic.messages.<span class="function">create</span>({
    model: <span class="string">'claude-sonnet-4-20250514'</span>,
    max_tokens: 1024,
    system: contextPrompt,
    messages: messages.<span class="function">map</span>((m: <span class="keyword">any</span>) => ({
      role: m.role,
      content: m.content
    }))
  });

  <span class="keyword">const</span> textContent = response.content.<span class="function">find</span>(c => c.type === <span class="string">'text'</span>);

  <span class="keyword">return</span> <span class="function">NextResponse.json</span>({
    message: textContent?.text || <span class="string">'I apologize, I couldn\'t generate a response.'</span>
  });
}</code></pre>
                </div>

                <h3 id="phase-5">Phase 5: Skin Type Analysis Prompts</h3>
                <p>Create specialized prompts for analyzing user skin concerns and generating targeted recommendations.</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">typescript</span>
                        <button class="code-copy-btn" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code><span class="comment">// lib/beautyPrompts.ts</span>

<span class="keyword">export const</span> SKIN_ANALYSIS_PROMPT = <span class="string">`Analyze the user's skin profile and provide:

1. **Skin Type Assessment**
   - Primary type (oily, dry, combination, normal, sensitive)
   - Secondary characteristics
   - Seasonal variations to expect

2. **Concern Priority Ranking**
   - Rank their concerns from most to least addressable
   - Explain which concerns should be tackled first and why

3. **Ingredient Recommendations**
   - Must-have ingredients for their skin type
   - Ingredients to avoid
   - Power combinations that work well together

4. **Red Flags**
   - Signs that indicate they should see a dermatologist
   - Potential sensitivities to watch for`</span>;

<span class="keyword">export const</span> ROUTINE_BUILDER_PROMPT = <span class="string">`Create a personalized skincare routine:

**Morning Routine:**
1. Cleanser - [recommendation + why]
2. Toner/Essence - [if applicable]
3. Serum - [targeted treatment]
4. Moisturizer - [based on skin type]
5. SPF - [always!]

**Evening Routine:**
1. First Cleanse - [if wearing makeup/SPF]
2. Second Cleanse
3. Actives - [retinol, acids, etc. with frequency]
4. Serum
5. Night Cream/Sleeping Mask

**Weekly Treatments:**
- Exfoliation schedule
- Mask recommendations
- Special treatments

Include timing between steps and any layering order notes.`</span>;

<span class="keyword">export const</span> PRODUCT_COMPARISON_PROMPT = <span class="string">`Compare these products for the user:

For each product, analyze:
- Key active ingredients and their concentrations
- Best suited for which skin types
- Potential irritation factors
- Value for money
- How it fits into a routine

Provide a clear recommendation with reasoning.`</span>;

<span class="keyword">export const</span> INGREDIENT_ANALYSIS_PROMPT = <span class="string">`Analyze this ingredient list:

1. **Star Ingredients** - What's great about this formula
2. **Potential Irritants** - What might cause issues
3. **Missing Elements** - What could make it better
4. **Conflicts** - Ingredients that shouldn't be mixed
5. **Best Paired With** - Complementary products/ingredients

Rate the product's ingredient quality on a scale of 1-10 for:
- Effectiveness
- Gentleness
- Value
- Innovation`</span>;</code></pre>
                </div>

                <h3 id="phase-6">Phase 6: Routine Builder Feature</h3>
                <p>Implement the visual routine builder that displays personalized AM/PM skincare routines.</p>

                <div class="code-block">
                    <div class="code-header">
                        <span class="code-lang">tsx</span>
                        <button class="code-copy-btn" aria-label="Copy code">Copy</button>
                    </div>
                    <pre><code><span class="comment">// components/RoutineBuilder.tsx</span>
<span class="keyword">interface</span> RoutineStep {
  order: <span class="keyword">number</span>;
  category: <span class="keyword">string</span>;
  product: <span class="keyword">string</span>;
  timing: <span class="keyword">string</span>;
  notes: <span class="keyword">string</span>;
}

<span class="keyword">interface</span> RoutineProps {
  morningRoutine: RoutineStep[];
  eveningRoutine: RoutineStep[];
}

<span class="keyword">export default function</span> <span class="function">RoutineBuilder</span>({ morningRoutine, eveningRoutine }: RoutineProps) {
  <span class="keyword">return</span> (
    &lt;div className=<span class="string">"grid md:grid-cols-2 gap-6 p-6"</span>&gt;
      {<span class="comment">/* Morning Routine */</span>}
      &lt;div className=<span class="string">"bg-gradient-to-br from-amber-50 to-orange-50 rounded-2xl p-6"</span>&gt;
        &lt;h3 className=<span class="string">"text-xl font-bold text-amber-800 mb-4 flex items-center gap-2"</span>&gt;
          ‚òÄÔ∏è Morning Routine
        &lt;/h3&gt;
        &lt;div className=<span class="string">"space-y-3"</span>&gt;
          {morningRoutine.<span class="function">map</span>((step, i) =&gt; (
            &lt;div key={i} className=<span class="string">"bg-white rounded-xl p-4 shadow-sm"</span>&gt;
              &lt;div className=<span class="string">"flex items-center gap-3"</span>&gt;
                &lt;span className=<span class="string">"w-8 h-8 bg-amber-100 rounded-full flex items-center justify-center text-amber-600 font-bold"</span>&gt;
                  {step.order}
                &lt;/span&gt;
                &lt;div&gt;
                  &lt;p className=<span class="string">"font-medium text-gray-800"</span>&gt;{step.category}&lt;/p&gt;
                  &lt;p className=<span class="string">"text-sm text-gray-600"</span>&gt;{step.product}&lt;/p&gt;
                &lt;/div&gt;
              &lt;/div&gt;
              {step.notes &amp;&amp; (
                &lt;p className=<span class="string">"mt-2 text-xs text-gray-500 italic"</span>&gt;{step.notes}&lt;/p&gt;
              )}
            &lt;/div&gt;
          ))}
        &lt;/div&gt;
      &lt;/div&gt;

      {<span class="comment">/* Evening Routine */</span>}
      &lt;div className=<span class="string">"bg-gradient-to-br from-indigo-50 to-purple-50 rounded-2xl p-6"</span>&gt;
        &lt;h3 className=<span class="string">"text-xl font-bold text-indigo-800 mb-4 flex items-center gap-2"</span>&gt;
          üåô Evening Routine
        &lt;/h3&gt;
        &lt;div className=<span class="string">"space-y-3"</span>&gt;
          {eveningRoutine.<span class="function">map</span>((step, i) =&gt; (
            &lt;div key={i} className=<span class="string">"bg-white rounded-xl p-4 shadow-sm"</span>&gt;
              &lt;div className=<span class="string">"flex items-center gap-3"</span>&gt;
                &lt;span className=<span class="string">"w-8 h-8 bg-indigo-100 rounded-full flex items-center justify-center text-indigo-600 font-bold"</span>&gt;
                  {step.order}
                &lt;/span&gt;
                &lt;div&gt;
                  &lt;p className=<span class="string">"font-medium text-gray-800"</span>&gt;{step.category}&lt;/p&gt;
                  &lt;p className=<span class="string">"text-sm text-gray-600"</span>&gt;{step.product}&lt;/p&gt;
                &lt;/div&gt;
              &lt;/div&gt;
              {step.timing &amp;&amp; (
                &lt;p className=<span class="string">"mt-2 text-xs text-purple-600"</span>&gt;‚è±Ô∏è {step.timing}&lt;/p&gt;
              )}
            &lt;/div&gt;
          ))}
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;
  );
}</code></pre>
                </div>

                <!-- Section: Common Issues -->
                <h2 id="common-issues">Common Issues & Solutions</h2>
                <p>Here are some common issues you might encounter and how to solve them:</p>

                <div class="callout callout-warning">
                    <div class="callout-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                        Rate Limiting with Claude API
                    </div>
                    <p>If you hit rate limits, implement exponential backoff in your API route. Consider caching common responses in Supabase to reduce API calls.</p>
                </div>

                <div class="callout callout-warning">
                    <div class="callout-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>
                        Long Response Times
                    </div>
                    <p>Beauty recommendations can be detailed. Use streaming responses with the Anthropic SDK to show text as it's generated, improving perceived performance.</p>
                </div>

                <div class="callout callout-info">
                    <div class="callout-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>
                        Supabase Connection Issues
                    </div>
                    <p>Ensure your Supabase URL and anon key are correctly set in your .env.local file. Check that Row Level Security (RLS) policies allow the operations you need.</p>
                </div>

                <!-- Section: Next Steps -->
                <h2 id="next-steps">Next Steps</h2>
                <p>Congratulations on building your AI Beauty Consultant! Here are some ways to enhance it further:</p>

                <ul>
                    <li><strong>Add image upload</strong> - Let users upload photos for visual skin analysis using Claude's vision capabilities</li>
                    <li><strong>Integrate product APIs</strong> - Connect to Sephora, Ulta, or beauty brand APIs for real-time product data and pricing</li>
                    <li><strong>Build a recommendation history</strong> - Track which products users tried and their results to improve future suggestions</li>
                    <li><strong>Add authentication</strong> - Use Supabase Auth to save user profiles and preferences across sessions</li>
                    <li><strong>Create shareable routines</strong> - Let users share their personalized routines via social media or direct link</li>
                </ul>

                <div class="callout callout-tip">
                    <div class="callout-title">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><path d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"/></svg>
                        Deploy to Production
                    </div>
                    <p>Push your code to GitHub and connect to Vercel for instant deployment. Don't forget to add your environment variables (ANTHROPIC_API_KEY, SUPABASE_URL, SUPABASE_ANON_KEY) in Vercel's project settings.</p>
                </div>

                <!-- Share Section -->
                <div class="share-section">
                    <span class="share-label">Share this guide:</span>
                    <div class="share-buttons" role="group" aria-label="Share this guide">
                        <button class="share-btn" data-share="twitter" title="Share on Twitter" aria-label="Share on Twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/>
                            </svg>
                        </button>
                        <button class="share-btn" data-share="linkedin" title="Share on LinkedIn" aria-label="Share on LinkedIn">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true">
                                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                            </svg>
                        </button>
                        <button class="share-btn" data-share="copy" title="Copy link" aria-label="Copy link to clipboard">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path>
                                <path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path>
                            </svg>
                        </button>
                        <button class="share-btn" data-share="email" title="Share via email" aria-label="Share via email">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true">
                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path>
                                <polyline points="22,6 12,13 2,6"></polyline>
                            </svg>
                        </button>
                    </div>
                </div>

                <!-- Related Guides -->
                <div class="related-guides">
                    <h3 class="related-guides-title">Related Guides</h3>
                    <div class="related-guides-grid">
                        <a href="/guides/ai-fitness-coach.html" class="related-guide-card">
                            <h4>Build an AI Fitness Coach</h4>
                            <p>Create personalized workout plans with Claude API</p>
                        </a>
                        <a href="/guides/ecommerce-recommendation.html" class="related-guide-card">
                            <h4>AI Product Recommendations</h4>
                            <p>Build smart recommendation engines for e-commerce</p>
                        </a>
                        <a href="/guides/chatbot-fundamentals.html" class="related-guide-card">
                            <h4>Chatbot Fundamentals</h4>
                            <p>Master the basics of building AI chatbots</p>
                        </a>
                    </div>
                </div>

                <!-- Follow Section -->
                <div class="follow-section">
                    <h3>Follow the Vibe Coding Enthusiast</h3>
                    <p>Follow JD ‚Äî product updates on LinkedIn, personal takes on X.</p>
                    <div class="social-follow-buttons">
                        <a href="https://www.linkedin.com/in/jeremiahddavid/" target="_blank" rel="noopener noreferrer" class="social-follow-btn linkedin">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                            Follow on LinkedIn
                        </a>
                        <a href="https://x.com/jeremiahddavid" target="_blank" rel="noopener noreferrer" class="social-follow-btn twitter">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                            Follow on X
                        </a>
                    </div>
                </div>
            </article>
        </div>
    </main>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="backToTop" aria-label="Back to top">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <path d="M18 15l-6-6-6 6"/>
        </svg>
    </button>

        <footer class="footer">
    <div class="container">
        <div class="footer-simple">
            <div class="footer-brand">
                <a href="/" class="footer-logo">
                    <img src="/favicon.png" alt="Vibe Coding Enthusiast" class="logo-icon" width="28" height="28">
                    <span>Vibe Coding Enthusiast</span>
                </a>
                <p>Free guides for building with AI</p>
            </div>

            <nav class="footer-nav">
                <a href="/guides/">Guides</a>
                <span class="footer-dot">¬∑</span>
                <a href="/paths/">Paths</a>
                <span class="footer-dot">¬∑</span>
                <a href="/learn/">Learn</a>
                <span class="footer-dot">¬∑</span>
                <a href="/tools/">Tools</a>
                <span class="footer-dot">¬∑</span>
                <a href="/stacks/">Stacks</a>
                <span class="footer-dot">¬∑</span>
                <a href="/#about">About</a>
            </nav>

            <div class="footer-social">
                <a href="https://www.linkedin.com/in/jeremiahddavid/" target="_blank" rel="noopener noreferrer" aria-label="Follow on LinkedIn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/></svg>
                </a>
                <a href="https://x.com/jeremiahddavid" target="_blank" rel="noopener noreferrer" aria-label="Follow on X">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"/></svg>
                </a>
            </div>
        </div>

        <div class="footer-bottom">
            <p>¬© 2025 Vibe Coding Enthusiast</p>
            <div class="footer-legal">
                <a href="/privacy.html">Privacy</a>
                <a href="/terms.html">Terms</a>
            </div>
        </div>
    </div>
</footer>

    <script src="/script.js"></script>

    <!-- Guide-Specific JavaScript -->
    <script>
        // Reading Progress Bar
        (function() {
            const progressBar = document.getElementById('readingProgress');
            const article = document.querySelector('.article-content');

            if (progressBar && article) {
                window.addEventListener('scroll', function() {
                    const articleTop = article.offsetTop;
                    const articleHeight = article.offsetHeight;
                    const windowHeight = window.innerHeight;
                    const scrollTop = window.scrollY;

                    const progress = Math.min(100, Math.max(0,
                        ((scrollTop - articleTop + windowHeight * 0.3) / articleHeight) * 100
                    ));

                    progressBar.style.width = progress + '%';
                    progressBar.setAttribute('aria-valuenow', Math.round(progress));
                });
            }
        })();

        // Generate Table of Contents
        (function() {
            const article = document.querySelector('.article-content');
            const tocList = document.getElementById('tocList');

            if (article && tocList) {
                const headings = article.querySelectorAll('h2, h3');
                let tocHTML = '';

                headings.forEach(function(heading) {
                    const id = heading.getAttribute('id');
                    const text = heading.textContent.replace(/#/g, '').trim();
                    const level = heading.tagName.toLowerCase();
                    const className = level === 'h3' ? 'toc-h3' : '';

                    if (id) {
                        tocHTML += '<li><a href="#' + id + '" class="' + className + '">' + text + '</a></li>';

                        // Add anchor link to heading
                        const anchor = document.createElement('a');
                        anchor.href = '#' + id;
                        anchor.className = 'anchor-link';
                        anchor.setAttribute('aria-label', 'Link to ' + text);
                        anchor.textContent = '#';
                        heading.appendChild(anchor);
                    }
                });

                tocList.innerHTML = tocHTML;

                // Highlight active TOC item on scroll
                const tocLinks = tocList.querySelectorAll('a');

                function updateActiveTOC() {
                    const scrollPos = window.scrollY + 120;

                    headings.forEach(function(heading, index) {
                        const id = heading.getAttribute('id');
                        const headingTop = heading.offsetTop;
                        const nextHeading = headings[index + 1];
                        const nextTop = nextHeading ? nextHeading.offsetTop : document.body.scrollHeight;

                        if (scrollPos >= headingTop && scrollPos < nextTop) {
                            tocLinks.forEach(function(link) {
                                link.classList.remove('active');
                                if (link.getAttribute('href') === '#' + id) {
                                    link.classList.add('active');
                                }
                            });
                        }
                    });
                }

                window.addEventListener('scroll', updateActiveTOC);
                updateActiveTOC();
            }
        })();

        // Copy Code Button
        (function() {
            const copyButtons = document.querySelectorAll('.code-copy-btn');

            copyButtons.forEach(function(button) {
                button.addEventListener('click', function() {
                    const codeBlock = this.closest('.code-block');
                    const code = codeBlock.querySelector('code');
                    const text = code.textContent;

                    navigator.clipboard.writeText(text).then(function() {
                        button.textContent = 'Copied!';
                        button.classList.add('copied');

                        setTimeout(function() {
                            button.textContent = 'Copy';
                            button.classList.remove('copied');
                        }, 2000);
                    }).catch(function(err) {
                        console.error('Failed to copy:', err);
                    });
                });
            });
        })();

        // Share Buttons
        (function() {
            const shareButtons = document.querySelectorAll('.share-btn');
            const pageTitle = document.title;
            const pageUrl = window.location.href;

            shareButtons.forEach(function(button) {
                button.addEventListener('click', function() {
                    const shareType = this.getAttribute('data-share');
                    let shareUrl = '';

                    switch(shareType) {
                        case 'twitter':
                            shareUrl = 'https://twitter.com/intent/tweet?text=' + encodeURIComponent(pageTitle) + '&url=' + encodeURIComponent(pageUrl);
                            window.open(shareUrl, '_blank', 'width=550,height=420');
                            break;
                        case 'linkedin':
                            shareUrl = 'https://www.linkedin.com/sharing/share-offsite/?url=' + encodeURIComponent(pageUrl);
                            window.open(shareUrl, '_blank', 'width=550,height=420');
                            break;
                        case 'copy':
                            navigator.clipboard.writeText(pageUrl).then(function() {
                                const originalTitle = button.getAttribute('title');
                                button.setAttribute('title', 'Link copied!');
                                setTimeout(function() {
                                    button.setAttribute('title', originalTitle);
                                }, 2000);
                            });
                            break;
                        case 'email':
                            shareUrl = 'mailto:?subject=' + encodeURIComponent(pageTitle) + '&body=' + encodeURIComponent('Check out this guide: ' + pageUrl);
                            window.location.href = shareUrl;
                            break;
                    }
                });
            });
        })();
    </script>
</body>
</html>
